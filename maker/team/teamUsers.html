<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>团队成员</title>
    <meta name="viewport" content="width=device-width, user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="msapplication-tap-highlight" content="no"/>
    <link rel="stylesheet" type="text/css" href="/assets/common/css/main.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/maker/css/team/team.css"/>
    <script type="text/javascript">/*resize.js*/
!function(a){function b(){var b=g.getBoundingClientRect().width;a.rem=(b/7.5>100?100:(b/7.5<40?40:b/7.5)),g.style.fontSize=a.rem+"px"}var g=a.document.documentElement,e;a.addEventListener("resize",function(){clearTimeout(e),e=setTimeout(b,300)},!1),a.addEventListener("pageshow",function(a){a.persisted&&(clearTimeout(e),e=setTimeout(b,300))},!1),b()}(window);</script>
    <script type="text/javascript" src="/assets/common/js/main.js"></script>
</head>
<body>
<header>
    <div class="m-header g-border-b">
        <div class="header-left"><a href="javascript:void(0)" onclick="goBack();" class="back"></a></div>
        团队成员列表
    </div>
</header>
<div class="wrapper padding-wrapper-top" id="container">
    <div class="team-users">
        <ul>
            <li class="title">
                <div class="col-xs-3">昵称</div>
                <div class="col-xs-3">层级</div>
                <div class="col-xs-3">本月销售</div>
                <div class="col-xs-3">邀请类别</div>
            </li>
            <li v-for="item in datas.teamMember">
                <div class="col-xs-3" v-text="item.userName"></div>
                <div class="col-xs-3" v-text="item.level | makerDeji"></div>
                <div class="col-xs-3" v-text="'¥'+item.monthlySellMoney"></div>
                <div class="col-xs-3" v-text="item.refType | refType">直拉/间拉</div>
            </li>
        </ul>
    </div>
    <!-- 底部element -->
    <div id='bottomscolltop'></div>
</div>
<!-- 模板js文件 -->
<script type="text/javascript">
/*创客team.js*/
//REF是拉人；SYS时系统推荐
Vue.filter('refType', function (value) {
    var text="";
    switch(value){
        case 'REF':
            text='拉人';
            break;
        case 'SYS':
            text='系统推荐';
            break;             
    }
    return text;
});

var vm = new Vue({
    el: '#container',
    data: {
        page:1, //分页起始页
        datas:[], //团队成员列表
    },
    ready: function(){
        var This = this;
        //获取团队成员列表
        $.AJAX({
            url: config.basePath+"maker/svMaker/getTeamMember",
            data:{
                level:0,   //int 当值为1时，查询其下一级的用户列表；当值为0时，查询其所有下级的用户列表
                page:1,   //int 页数，从1开始，默认1
                pageSize:15,   //int 每页个数，默认10个
            },
            success: function(data){
               This.datas=data.data;
               This.page=data.page;
               setTimeout(function(){
                $('.team-users').removeClass('hide');
               },config.containerShowTime);
            },
        });

    },
    methods: {
        //滚动获得更多数据
       scollGetMoreData:function(){
        var This=this;
        trueme.w.scrollGetData({
            lastObj:$('#bottomscolltop'),
            bottomTop:700,
            callback:function(){ 
              $.AJAX({
                  url:config.basePath+"maker/svMaker/getTeamMember",
                  data:{
                    startNum:This.startNum,
                    level:0,   //int 当值为1时，查询其下一级的用户列表；当值为0时，查询其所有下级的用户列表
                    page:This.page,   //int 页数，从1开始，默认1
                    pageSize:15,   //int 每页个数，默认10个
                  },
                  success:function(data){
                    //向数组里push数据
                    if(data.data.length>0){
                      This.datas = This.datas.concat(data.data);
                    }
                    This.page=data.page;
                    //判断是否还需要滚动获取数据
                    if(data.data.length>0){
                        config.scrollbegin=true; //可以再次滚动
                    }
                  }
             });  
            }
        });
       }, //end 
    }
});

    </script>
</body>
</html>